---
title: ä»£ç æ•´æ´ä¹‹é“
date: 2021-07-09 21:26:16
author: RuiLin Dong
permalink: /read/20210709092616
categories: 
  - å‰ªè´´æ¿
tags: 
  - å‰ªè´´æ¿
---
> æœ¬æ–‡æ‘˜è‡ªå­—èŠ‚æ•™è‚² [ã€Šä¸€ååˆæ ¼å‰ç«¯å·¥ç¨‹å¸ˆå¿…å¤‡ç´ è´¨ï¼šä»£ç æ•´æ´ä¹‹é“ã€‹](https://juejin.cn/post/6982538921586458638)

ä»£ç æ•´æ´æœ‰ä»€ä¹ˆç”¨ï¼Ÿ

- æ€è·¯æ¸…æ™°ï¼Œé™ä½bugå‡ ç‡
- æ›´å®¹æ˜“ç»´æŠ¤ï¼Œåˆ©äºå›¢é˜Ÿåä½œ
- çœ‹èµ·æ¥èˆ’æœï¼Œæé«˜æ•ˆç‡
......
è½¯ä»¶è´¨é‡ä¸ä»£ç æ•´æ´åº¦æˆæ­£æ¯” --Robert.C.Martin

è½¯ä»¶è®¾è®¡3Rå±‚æ¬¡ç»“æ„ï¼š readable, reusable, and refactorable å¯è¯»æ€§ã€å¯é‡ç”¨æ€§ã€å¯é‡æ„æ€§
image.png ä¸‹é¢è¿™äº›åŸåˆ™æ˜¯ä½œè€…æå‡ºçš„ä¸€äº›æœ€ä½³å®è·µï¼Œä½†ä¸æ˜¯å¼ºåˆ¶çº¦æŸ

å…³äºå‘½å
1.ä½¿ç”¨æœ‰æ„ä¹‰ä¸”æ˜“è¯»çš„å˜é‡å
```js
ğŸ‘ const yyyymmdstr = moment().format("YYYY/MM/DD");

ğŸ‘ const currentDate = moment().format("YYYY/MM/DD");
å¤åˆ¶ä»£ç 
2.ä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡ä»£æ›¿æ•°ç»„ä¸‹æ ‡
ğŸ‘ 
const address = "One Infinite Loop, Cupertino 95014";
const cityZipCodeRegex = /^[^,\\]+[,\\\s]+(.+?)\s*(\d{5})?$/;
saveCityZipCode(
  address.match(cityZipCodeRegex)[1],
  address.match(cityZipCodeRegex)[2]
);

ğŸ‘
const address = "One Infinite Loop, Cupertino 95014";
const cityZipCodeRegex = /^[^,\\]+[,\\\s]+(.+?)\s*(\d{5})?$/;
const [_, city, zipCode] = address.match(cityZipCodeRegex) || [];
saveCityZipCode(city, zipCode);
```

3.å˜é‡åè¦ç®€æ´ï¼Œä¸è¦é™„åŠ æ— ç”¨ä¿¡æ¯
```js
ğŸ‘ 
const Car = {
  carMake: "Honda",
  carModel: "Accord",
  carColor: "Blue"
};
function paintCar(car, color) {
  car.carColor = color;
}

ğŸ‘
const Car = {
  make: "Honda",
  model: "Accord",
  color: "Blue"
};
function paintCar(car, color) {
  car.color = color;
}
```
4.æ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²
```js
ğŸ‘ setTimeout(blastOff, 86400000);

ğŸ‘ const MILLISECONDS_PER_DAY = 60 * 60 * 24 * 1000; //86400000;
setTimeout(blastOff, MILLISECONDS_PER_DAY);
```
5.ä½¿ç”¨é»˜è®¤å‚æ•°æ›¿ä»£çŸ­è·¯è¿ç®—ç¬¦
```js
ğŸ‘
function createMicrobrewery(name) {
  const breweryName = name || "Hipster Brew Co.";
  // ...
}

ğŸ‘ 
function createMicrobrewery(name = "Hipster Brew Co.") {
  // ...
}
```
å…³äºå‡½æ•°
1.ä¸€ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹çš„å¥½å¤„åœ¨äºæ˜“äºç†è§£ã€æ˜“äºæµ‹è¯•ã€‚
```js
ğŸ‘
function emailClients(clients) {
  clients.forEach(client => {
    const clientRecord = database.lookup(client);
    if (clientRecord.isActive()) {
      email(client);
    }
  });
}

ğŸ‘ 
function emailActiveClients(clients) {
  clients.filter(isActiveClient).forEach(email);
}
function isActiveClient(client) {
  const clientRecord = database.lookup(client);
  return clientRecord.isActive();
}
```
---------------------åˆ†å‰²çº¿-----------------------

```js
ğŸ‘
function createFile(name, temp) {
  if (temp) {
    fs.create(`./temp/${name}`);
  } else {
    fs.create(name);
  }
}

ğŸ‘ 
function createFile(name) {
  fs.create(name);
}
function createTempFile(name) {
  createFile(`./temp/${name}`);
}

```
2.å‡½æ•°å‚æ•°ä¸å¤šäº2ä¸ªï¼Œå¦‚æœæœ‰å¾ˆå¤šå‚æ•°å°±åˆ©ç”¨objectä¼ é€’ï¼Œå¹¶ä½¿ç”¨è§£æ„ã€‚
æ¨èä½¿ç”¨è§£æ„çš„å‡ ä¸ªåŸå› :

çœ‹åˆ°å‡½æ•°ç­¾åå¯ä»¥ç«‹å³äº†è§£æœ‰å“ªäº›å‚æ•°
è§£æ„èƒ½å…‹éš†ä¼ é€’åˆ°å‡½æ•°ä¸­çš„å‚æ•°å¯¹è±¡çš„å€¼(æµ…å…‹éš†)ï¼Œæœ‰åŠ©äºé˜²æ­¢å‰¯ä½œç”¨.
linterå¯ä»¥æç¤ºæœ‰å“ªäº›å‚æ•°æœªè¢«ä½¿ç”¨
```js
ğŸ‘
function createMenu(title, body, buttonText, cancellable) {
  // ...
}
createMenu("Foo", "Bar", "Baz", true);

ğŸ‘ 
function createMenu({ title, body, buttonText, cancellable }) {
  // ...
}
createMenu({
  title: "Foo",
  body: "Bar",
  buttonText: "Baz",
  cancellable: true
});
```
3.å‡½æ•°ååº”è¯¥ç›´æ¥åæ˜ å‡½æ•°çš„ä½œç”¨
```js
ğŸ‘
function addToDate(date, month) {
  // ...
}
const date = new Date();
// It's hard to tell from the function name what is added
addToDate(date, 1);

ğŸ‘ 
function addMonthToDate(month, date) {
  // ...
}
const date = new Date();
addMonthToDate(1, date);
```
4.ä¸€ä¸ªå‡½æ•°çš„æŠ½è±¡å±‚çº§ä¸è¦å¤ªå¤šï¼Œå¦‚æœä½ çš„å‡½æ•°åšäº†å¤ªå¤šäº‹ï¼Œå°±éœ€è¦æŠŠå®ƒæ‹†åˆ†æˆå¤šä¸ªå‡½æ•°
```js
ğŸ‘
function parseBetterJSAlternative(code) {
  const REGEXES = [
    // ...
  ];

  const statements = code.split(" ");
  const tokens = [];
  REGEXES.forEach(REGEX => {
    statements.forEach(statement => {
      // ...
    });
  });

  const ast = [];
  tokens.forEach(token => {
    // lex...
  });

  ast.forEach(node => {
    // parse...
  });
}

ğŸ‘ 
function parseBetterJSAlternative(code) {
  const tokens = tokenize(code);
  const syntaxTree = parse(tokens);
  syntaxTree.forEach(node => {
    // parse...
  });
}
function tokenize(code) {
  const REGEXES = [
    // ...
  ];

  const statements = code.split(" ");
  const tokens = [];
  REGEXES.forEach(REGEX => {
    statements.forEach(statement => {
      tokens.push(/* ... */);
    });
  });

  return tokens;
}
function parse(tokens) {
  const syntaxTree = [];
  tokens.forEach(token => {
    syntaxTree.push(/* ... */);
  });

  return syntaxTree;
}

```
5.å‡å°‘é‡å¤ä»£ç 
```js
ğŸ‘
function showDeveloperList(developers) {
  developers.forEach(developer => {
    const expectedSalary = developer.calculateExpectedSalary();
    const experience = developer.getExperience();
    const githubLink = developer.getGithubLink();
    const data = {
      expectedSalary,
      experience,
      githubLink
    };

    render(data);
  });
}
function showManagerList(managers) {
  managers.forEach(manager => {
    const expectedSalary = manager.calculateExpectedSalary();
    const experience = manager.getExperience();
    const portfolio = manager.getMBAProjects();
    const data = {
      expectedSalary,
      experience,
      portfolio
    };

    render(data);
  });
}

ğŸ‘ 
function showEmployeeList(employees) {
  employees.forEach(employee => {
    const expectedSalary = employee.calculateExpectedSalary();
    const experience = employee.getExperience();

    const data = {
      expectedSalary,
      experience
    };

    switch (employee.type) {
      case "manager":
        data.portfolio = employee.getMBAProjects();
        break;
      case "developer":
        data.githubLink = employee.getGithubLink();
        break;
    }

    render(data);
  });
}

```
6.å°½é‡ä½¿ç”¨çº¯å‡½æ•° (å‡½æ•°å¼ç¼–ç¨‹,notå‘½ä»¤å¼ç¼–ç¨‹)
```js
ğŸ‘
const programmerOutput = [
  {
    name: "Uncle Bobby",
    linesOfCode: 500
  },
  {
    name: "Suzie Q",
    linesOfCode: 1500
  },
  {
    name: "Jimmy Gosling",
    linesOfCode: 150
  },
  {
    name: "Gracie Hopper",
    linesOfCode: 1000
  }
];
let totalOutput = 0;
for (let i = 0; i < programmerOutput.length; i++) {
  totalOutput += programmerOutput[i].linesOfCode;
}

ğŸ‘ 
const programmerOutput = [
  {
    name: "Uncle Bobby",
    linesOfCode: 500
  },
  {
    name: "Suzie Q",
    linesOfCode: 1500
  },
  {
    name: "Jimmy Gosling",
    linesOfCode: 150
  },
  {
    name: "Gracie Hopper",
    linesOfCode: 1000
  }
];
const totalOutput = programmerOutput.reduce(
  (totalLines, output) => totalLines + output.linesOfCode,
  0
);
```
7.æ³¨æ„å‡½æ•°çš„å‰¯ä½œç”¨
```js
ğŸ‘
const addItemToCart = (cart, item) => {
  cart.push({ item, date: Date.now() });
};

ğŸ‘ 
const addItemToCart = (cart, item) => {
  return [...cart, { item, date: Date.now() }];
};
```
8.ä¸è¦è¿‡åº¦ä¼˜åŒ–
ç°ä»£æµè§ˆå™¨åœ¨è¿è¡Œæ—¶è¿›è¡Œäº†å¤§é‡çš„ä¼˜åŒ–ã€‚å¾ˆå¤šæ—¶å€™ï¼Œå¦‚æœä½ å†ä¼˜åŒ–ï¼Œé‚£å°±æ˜¯åœ¨æµªè´¹æ—¶é—´ã€‚
```js
ğŸ‘
// On old browsers, each iteration with uncached `list.length` would be costly
// because of `list.length` recomputation. In modern browsers, this is optimized.
for (let i = 0, len = list.length; i < len; i++) {
  // ...
}

ğŸ‘ 
for (let i = 0; i < list.length; i++) {
  // ...
}
```
å…³äºæ³¨é‡Š
1.Comments are an apology, not a requirement. Good code mostly documents itself.
å¥½çš„ä»£ç æ˜¯è‡ªæ³¨é‡Šçš„
```js
ğŸ‘
function hashIt(data) {
  // The hash
  let hash = 0;

  // Length of string
  const length = data.length;

  // Loop through every character in data
  for (let i = 0; i < length; i++) {
    // Get character code.
    const char = data.charCodeAt(i);
    // Make the hash
    hash = (hash << 5) - hash + char;
    // Convert to 32-bit integer
    hash &= hash;
  }
}

ğŸ‘ 
function hashIt(data) {
  let hash = 0;
  const length = data.length;

  for (let i = 0; i < length; i++) {
    const char = data.charCodeAt(i);
    hash = (hash << 5) - hash + char;

    // Convert to 32-bit integer
    hash &= hash;
  }
}
```
2.gitèƒ½åšçš„äº‹ä¸è¦å†™åœ¨æ³¨é‡Šé‡Œ
```js
ğŸ‘
/**
 * 2016-12-20: Removed monads, didn't understand them (RM)
 * 2016-10-01: Improved using special monads (JP)
 * 2016-02-03: Removed type-checking (LI)
 * 2015-03-14: Added combine with type-checking (JR)
 */
function combine(a, b) {
  return a + b;
}

ğŸ‘ 
function combine(a, b) {
  return a + b;
}
```
å…³äºç»„ä»¶
1.å°½å¯èƒ½ä½¿ç”¨å‡½æ•°ç»„ä»¶
å‡½æ•°å¼ç»„ä»¶æœ‰æ›´ç®€å•çš„è¯­æ³•ï¼Œæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œæ„é€ å‡½æ•°ã€‚åŒæ ·çš„é€»è¾‘å’Œå¯é æ€§ï¼Œå‡½æ•°å¼ç»„ä»¶å¯ä»¥ç”¨æ›´å°‘çš„ä»£ç å®Œæˆã€‚
```js
ğŸ‘ 
class Counter extends React.Component {
  state = {
    counter: 0,
  }

  constructor(props) {
    super(props)
    this.handleClick = this.handleClick.bind(this)
  }

  handleClick() {
    this.setState({ counter: this.state.counter + 1 })
  }

  render() {
    return (
      <div>
        <p>counter: {this.state.counter}</p>
        <button onClick={this.handleClick}>Increment</button>
      </div>
    )
  }
}
ğŸ‘
function Counter() {
  const [counter, setCounter] = useState(0)

  handleClick = () => setCounter(counter + 1)

  return (
    <div>
      <p>counter: {counter}</p>
      <button onClick={handleClick}>Increment</button>
    </div>
  )
}
```
2.å‡½æ•°ç»„ä»¶ä¸­å‰¥ç¦»é€»è¾‘ä»£ç 
å°½å¯èƒ½çš„æŠŠé€»è¾‘ä»ç»„ä»¶ä¸­å‰¥ç¦»å‡ºå»ï¼Œå¯ä»¥æŠŠå¿…è¦çš„å€¼ç”¨å‚æ•°çš„å½¢å¼ä¼ ç»™å·¥å…·ç±»å‡½æ•°ã€‚åœ¨å‡½æ•°ç»„ä»¶å¤–ç»„ç»‡ä½ çš„é€»è¾‘è®©ä½ èƒ½å¤Ÿæ›´ç®€å•çš„å»è¿½è¸ª bug å’Œæ‰©å±•ä½ çš„åŠŸèƒ½ã€‚
```js
ğŸ‘
export default function Component() {
  const [value, setValue] = useState('')

  function isValid() {
    // ...
  }

  return (
    <>
      <input
        value={value}
        onChange={e => setValue(e.target.value)}
        onBlur={validateInput}
      />
      <button
        onClick={() => {
          if (isValid) {
            // ...
          }
        }}
      >
        Submit
      </button>
    </>
  )
}

ğŸ‘ 
function isValid(value) {
  // ...
}
export default function Component() {
  const [value, setValue] = useState('')

  return (
    <>
      <input
        value={value}
        onChange={e => setValue(e.target.value)}
        onBlur={validateInput}
      />
      <button
        onClick={() => {
          if (isValid(value)) {
            // ...
          }
        }}
      >
        Submit
      </button>
    </>
  )
}
```
3.æ§åˆ¶ç»„ä»¶é•¿åº¦ï¼Œå‡å°‘UIè€¦åˆ
å‡½æ•°ç»„ä»¶ä¹Ÿæ˜¯å‡½æ•°ï¼ŒåŒæ ·è¦æ§åˆ¶é•¿åº¦ï¼Œå¦‚æœç»„ä»¶å¤ªé•¿ï¼Œå°±è¦æ‹†æˆå¤šä¸ªç»„ä»¶
```js
ğŸ‘
function Filters({ onFilterClick }) {
  return (
    <>
      <p>Book Genres</p>
      <ul>
        <li>
          <div onClick={() => onFilterClick('fiction')}>Fiction</div>
        </li>
        <li>
          <div onClick={() => onFilterClick('classics')}>
            Classics
          </div>
        </li>
        <li>
          <div onClick={() => onFilterClick('fantasy')}>Fantasy</div>
        </li>
        <li>
          <div onClick={() => onFilterClick('romance')}>Romance</div>
        </li>
      </ul>
    </>
  )
}

// ğŸ‘ Use loops and configuration objects
const GENRES = [
  {
    identifier: 'fiction',
    name: Fiction,
  },
  {
    identifier: 'classics',
    name: Classics,
  },
  {
    identifier: 'fantasy',
    name: Fantasy,
  },
  {
    identifier: 'romance',
    name: Romance,
  },
]

function Filters({ onFilterClick }) {
  return (
    <>
      <p>Book Genres</p>
      <ul>
        {GENRES.map(genre => (
          <li>
            <div onClick={() => onFilterClick(genre.identifier)}>
              {genre.name}
            </div>
          </li>
        ))}
      </ul>
    </>
  )
}
```
4.å°½é‡é¿å…å‡½æ•°ç»„ä»¶å†…å†å®šä¹‰å‡½æ•°ç»„ä»¶
ä¸è¦åœ¨ä¸€ä¸ªå‡½æ•°ç»„ä»¶ä¸­å†å»ä¹¦å†™ä¸€ä¸ªå‡½æ•°ç»„ä»¶ã€‚ä¸€ä¸ªå‡½æ•°ç»„ä»¶åº”è¯¥ä»…ä»…æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å‡½æ•°ç»„ä»¶å†…éƒ¨å†å®šä¹‰å‡½æ•°ç»„ä»¶ï¼Œæ„å‘³ç€å†…éƒ¨çš„å‡½æ•°ç»„ä»¶èƒ½å¤Ÿé€šè¿‡ä½œç”¨åŸŸè®¿é—®åˆ°å¤–å±‚ç»„ä»¶æ‰€æœ‰çš„ state å’Œ propsï¼Œè¿™æ ·ä¼šä½¿å†…éƒ¨å®šä¹‰ç»„ä»¶ä¸å¯é ã€‚æŠŠå†…éƒ¨çš„ç»„ä»¶ç§»åˆ°å¤–éƒ¨ï¼Œé¿å…é—­åŒ…å’Œä½œç”¨åŸŸçš„å½±å“ã€‚

```js
// ğŸ‘ Don't write nested render functions
function Component() {
  function renderHeader() {
    return <header>...</header>
  }
  return <div>{renderHeader()}</div>
}
// ğŸ‘ Extract it in its own component
import Header from '@modules/common/components/Header'
function Component() {
  return (
    <div>
      <Header />
    </div>
  )
}
```

5.ä¼˜åŒ–props
æ§åˆ¶propsæ•°é‡ã€èšåˆpropsã€å®Œå–„æ¸²æŸ“æ¡ä»¶

å¦‚ä½•æŠŠæ§ props çš„é‡æ˜¯ä¸€ä¸ªå€¼å¾—å•†æ¦·çš„é—®é¢˜ã€‚ä½†æ˜¯ä¸€ä¸ªç»„ä»¶ä¼ é€’è¶Šå¤šçš„ props æ„å‘³ç€å®ƒåšçš„äº‹æƒ…è¶Šå¤šè¿™æ˜¯å…±è¯†ã€‚å½“ props è¾¾åˆ°ä¸€å®šæ•°é‡çš„æ—¶å€™ï¼Œæ„å‘³ç€è¿™ä¸ªç»„ä»¶åšçš„äº‹æƒ…å¤ªå¤šäº†ã€‚ å½“propsçš„æ•°é‡è¾¾åˆ°5ä¸ªä»¥ä¸Šçš„æ—¶å€™ï¼Œè¿™ä¸ªç»„ä»¶å°±éœ€è¦è¢«æ‹†åˆ†äº†ã€‚åœ¨æŸäº›æç«¯è¯¸å¦‚è¾“å…¥ç±»å‹ç»„ä»¶çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½æ‹¥æœ‰è¿‡å¤šçš„propsï¼Œä½†åœ¨é€šå¸¸æƒ…å†µä¸‹5ä¸ªpropsèƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†ç»„ä»¶çš„éœ€æ±‚ã€‚
æç¤ºï¼šä¸€ä¸ªç»„ä»¶æ‹¥æœ‰è¶Šå¤šçš„ propsï¼Œè¶Šå®¹æ˜“è¢« rerenderã€‚

ä¸€äº›åœºæ™¯ä¸‹ä½¿ç”¨çŸ­è·¯è¯­æ³•æ¥è¿›è¡Œæ¡ä»¶æ¸²æŸ“å¯èƒ½å¯¼è‡´æœŸæœ›ä¹‹å¤–çš„é—®é¢˜ï¼Œæœ‰å¯èƒ½ä¼šæ¸²æŸ“ä¸€ä¸ª 0 åœ¨ç•Œé¢ä¸Šã€‚é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œå°½é‡ä½¿ç”¨ä¸‰å…ƒæ“ä½œç¬¦ã€‚ å°½ç®¡çŸ­è·¯æ“ä½œç¬¦èƒ½ä½¿ä»£ç å˜å¾—ç®€æ´ï¼Œä½†æ˜¯ä¸‰å…ƒæ“ä½œç¬¦èƒ½å¤Ÿä¿è¯æ¸²æŸ“çš„æ­£ç¡®æ€§ã€‚
```js
// ğŸ‘ Try to avoid short-circuit operators
function Component() {
  const count = 0

  return <div>{count && <h1>Messages: {count}</h1>}</div>
}
// ğŸ‘ Use a ternary instead
function Component() {
  const count = 0

  return <div>{count ? <h1>Messages: {count}</h1> : null}</div>
}
```
å…³äºå…¶ä»–
1.æŠŠç»„ä»¶æ”¾å…¥å•ç‹¬çš„æ–‡ä»¶å¤¹ä¸­
```js
// ğŸ‘ Don't keep all component files together
â”œâ”€â”€ components
    â”œâ”€â”€ Header.jsx
    â”œâ”€â”€ Header.scss
    â”œâ”€â”€ Header.test.jsx
    â”œâ”€â”€ Footer.jsx
    â”œâ”€â”€ Footer.scss
    â”œâ”€â”€ Footer.test.jsx

// ğŸ‘ Move them in their own folder
â”œâ”€â”€ components
    â”œâ”€â”€ Header
        â”œâ”€â”€ index.js
        â”œâ”€â”€ Header.jsx
        â”œâ”€â”€ Header.scss
        â”œâ”€â”€ Header.test.jsx
    â”œâ”€â”€ Footer
        â”œâ”€â”€ index.js
        â”œâ”€â”€ Footer.jsx
        â”œâ”€â”€ Footer.scss
        â”œâ”€â”€ Footer.test.jsx
```

å‚è€ƒæ–‡çŒ®ï¼šã€Šä»£ç æ•´æ´ä¹‹é“ã€‹
- [ryanmcdermott](https://github.com/ryanmcdermott/clean-code-javascript)
- [ryanmcdermott](https://github.com/ryanmcdermott/3rs-of-software-architecture)
- [alexkondov.com](https://alexkondov.com/tao-of-react/)
  
-- è‡³æ­¤å®Œ --